cabal-version:      3.0
name:               cardano-ledger-test
version:            0.1.1.0
license:            Apache-2.0
copyright:          2020 Input Output (Hong Kong) Ltd.
maintainer:         nicholas.clarke@iohk.io
author:             IOHK Formal Methods Team
synopsis:
    Testing harness, tests and benchmarks for Shelley style cardano ledgers

build-type:         Simple
extra-source-files: CHANGELOG.md

source-repository head
    type:     git
    location: https://github.com/input-output-hk/cardano-ledger
    subdir:   libs/cardano-ledger-test

library
    exposed-modules:
        Test.Cardano.Ledger.Alonzo.Tools
        Test.Cardano.Ledger.BaseTypes
        Test.Cardano.Ledger.Examples.BabbageFeatures
        Test.Cardano.Ledger.Examples.TwoPhaseValidation
        Test.Cardano.Ledger.Generic.AggPropTests
        Test.Cardano.Ledger.Generic.ApplyTx
        Test.Cardano.Ledger.Generic.Indexed
        Test.Cardano.Ledger.Generic.Fields
        Test.Cardano.Ledger.Generic.Functions
        Test.Cardano.Ledger.Generic.GenState
        Test.Cardano.Ledger.Generic.TxGen
        Test.Cardano.Ledger.Generic.Types
        Test.Cardano.Ledger.Generic.Proof
        Test.Cardano.Ledger.Generic.MockChain
        Test.Cardano.Ledger.Generic.ModelState
        Test.Cardano.Ledger.Generic.PrettyCore
        Test.Cardano.Ledger.Generic.Properties
        Test.Cardano.Ledger.Generic.Scriptic
        Test.Cardano.Ledger.Generic.Trace
        Test.Cardano.Ledger.Generic.Updaters
        Test.Cardano.Ledger.Model.API
        Test.Cardano.Ledger.Model.Acnt
        Test.Cardano.Ledger.Model.BaseTypes
        Test.Cardano.Ledger.Model.Elaborators
        Test.Cardano.Ledger.Model.Elaborators.Alonzo
        Test.Cardano.Ledger.Model.Elaborators.Shelley
        Test.Cardano.Ledger.Model.FeatureSet
        Test.Cardano.Ledger.Model.Fixup
        Test.Cardano.Ledger.Model.Generators
        Test.Cardano.Ledger.Model.Generators.Address
        Test.Cardano.Ledger.Model.Generators.Certificates
        Test.Cardano.Ledger.Model.Generators.Chain
        Test.Cardano.Ledger.Model.Generators.Script
        Test.Cardano.Ledger.Model.Generators.Shrinking
        Test.Cardano.Ledger.Model.Generators.Tx
        Test.Cardano.Ledger.Model.Generators.TxOut
        Test.Cardano.Ledger.Model.Generators.Value
        Test.Cardano.Ledger.Model.LedgerState
        Test.Cardano.Ledger.Model.PParams
        Test.Cardano.Ledger.Model.Properties
        Test.Cardano.Ledger.Model.Properties.Utils
        Test.Cardano.Ledger.Model.Prov
        Test.Cardano.Ledger.Model.Rewards
        Test.Cardano.Ledger.Model.Rules
        Test.Cardano.Ledger.Model.Script
        Test.Cardano.Ledger.Model.Snapshot
        Test.Cardano.Ledger.Model.Tx
        Test.Cardano.Ledger.Model.TxOut
        Test.Cardano.Ledger.Model.UTxO
        Test.Cardano.Ledger.Model.Value
        Test.Cardano.Ledger.NoThunks
        Test.Cardano.Ledger.Rational
        Test.Cardano.Ledger.TestableEra
        Test.Cardano.Ledger.ValueFromList

    hs-source-dirs:   src
    other-modules:
        Data.Group.GrpMap
        Data.Functor.PiecewiseConstant
        Test.Cardano.Ledger.Orphans

    default-language: Haskell2010
    ghc-options:
        -Wall -Wcompat -Wincomplete-record-updates
        -Wincomplete-uni-patterns -Wpartial-fields -Wredundant-constraints
        -Wunused-packages

    build-depends:
        base >=4.12 && <4.15,
        aeson >=2,
        array,
        bytestring,
        cardano-binary,
        cardano-crypto-class,
        cardano-data,
        cardano-ledger-alonzo,
        cardano-ledger-alonzo-test,
        cardano-ledger-babbage,
        cardano-ledger-conway,
        cardano-ledger-core,
        cardano-ledger-pretty,
        cardano-ledger-shelley-ma,
        cardano-protocol-tpraos,
        cardano-slotting,
        containers,
        vector-map,
        data-default-class,
        deepseq,
        genvalidity,
        genvalidity-scientific,
        groups,
        hkd,
        lens,
        microlens,
        monad-supply,
        mtl,
        nothunks,
        plutus-ledger-api,
        plutus-core,
        plutus-tx,
        prettyprinter,
        profunctors,
        QuickCheck,
        quickcheck-instances,
        QuickCheck-GenT,
        quiet,
        random,
        scientific,
        cardano-ledger-shelley,
        cardano-ledger-shelley-test,
        cardano-ledger-babbage-test,
        semigroupoids,
        small-steps,
        small-steps-test,
        set-algebra,
        some,
        strict-containers,
        tagged,
        tasty,
        tasty-hunit,
        tasty-quickcheck,
        text,
        time,
        transformers,
        vector,
        writer-cps-mtl

test-suite cardano-ledger-test
    type:             exitcode-stdio-1.0
    main-is:          Tests.hs
    hs-source-dirs:   test
    default-language: Haskell2010
    ghc-options:
        -Wall -Wcompat -Wincomplete-record-updates
        -Wincomplete-uni-patterns -Wpartial-fields -Wredundant-constraints
        -Wunused-packages -rtsopts -threaded

    build-depends:
        base >=4.12 && <4.15,
        cardano-ledger-test,
        cardano-ledger-shelley-test,
        tasty,
        data-default-class

benchmark bench
    type:             exitcode-stdio-1.0
    main-is:          Main.hs
    hs-source-dirs:   bench
    other-modules:
        Bench.Cardano.Ledger.ApplyTx
        Bench.Cardano.Ledger.ApplyTx.Gen
        Bench.Cardano.Ledger.EpochBoundary
        Bench.Cardano.Ledger.Serialisation.Generators
        Bench.Cardano.Ledger.SumStake
        Bench.Cardano.Ledger.TxOut

    default-language: Haskell2010
    ghc-options:
        -Wall -Wcompat -Wincomplete-record-updates
        -Wincomplete-uni-patterns -Wpartial-fields -Wredundant-constraints
        -Wunused-packages -threaded -rtsopts -O2

    build-depends:
        base >=4.12 && <4.15,
        bytestring,
        cardano-binary,
        cardano-crypto-class,
        cardano-data,
        cardano-ledger-alonzo,
        cardano-ledger-alonzo-test,
        cardano-ledger-core,
        cardano-ledger-shelley-ma-test,
        cardano-ledger-shelley-ma,
        vector-map,
        containers,
        criterion,
        data-default-class,
        deepseq,
        QuickCheck,
        cardano-ledger-shelley,
        cardano-ledger-shelley-test,
        microlens,
        random,
        small-steps,
        small-steps-test,
        text

benchmark benchProperty
    type:             exitcode-stdio-1.0
    main-is:          Main.hs
    hs-source-dirs:   benchProperty
    default-language: Haskell2010
    ghc-options:
        -Wall -Wcompat -Wincomplete-record-updates
        -Wincomplete-uni-patterns -Wpartial-fields -Wredundant-constraints
        -Wunused-packages -threaded -rtsopts -O2

    build-depends:
        base >=4.12 && <4.15,
        cardano-ledger-alonzo,
        cardano-ledger-alonzo-test,
        cardano-ledger-shelley-ma-test,
        QuickCheck,
        small-steps,
        cardano-ledger-shelley,
        cardano-ledger-shelley-test,
        tasty-quickcheck,
        tasty
